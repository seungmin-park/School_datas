# AI 프로그래밍 기말고사 정리

### 케라스로 신경망을 작성하는 방법

- Sequential 모델 생성

```python
model = tf.keras.models.Sequential()
```

- Add 함수를 통해 layer 추가

```python
# unit -> 은닉층, input_shape -> 입력층, activation -> 활성화 함수
model.add(tf.keras.layers.Dense(unit=2, input_shape=(2,), activation='sigmoid'))
```

- Compile 함수를 통해 모델은 컴파일

```python
# loss -> 손실 함수, optimizer -> 경사 하강법
model.compile(loss='mean_squared_error', optimizer=keras.optimizer.SGD(lr=0.3), metrics='accuracy')
```

- Fit 함수를 통해 학습 수행

```python
model.fit(X, y ,batch_size=1, epochs=10000)
```

- Predict 함수를 통해 모델을 테스트

```python
model.predict(X)
```

### 손실 함수

![image](https://user-images.githubusercontent.com/78605779/171832136-8f8dd5ce-27d3-4551-8ed4-d3d19cf87f1b.png)

**대부분 평균 제곱 계열은 회귀에서, 교차 엔트로피 계열은 분류에서 사용한다**

### 경사 하강법 종류

**종류별로 어떻게 세팅해야하는지 나올 예정**

![image](https://user-images.githubusercontent.com/78605779/171832297-5ae0271b-ad1a-46d4-b514-c164e9eeead8.png)
![image](https://user-images.githubusercontent.com/78605779/171832345-1ecc2cdc-c806-4dc7-b72e-9d892c11574f.png)

`확률적 경사 하강법(SGD)`

```python
#Adagrad 함수 사용
optimizer=tf.keras.optimizers.SGD(lr=0.1)
```

`모멘텀(Momentom)`

```python
#Adagrad 함수 사용 + 파라미터에 momentum 추가
optimizer=tf.keras.optimizers.SGD(lr=0.1, momentum = 0.9)
```

`네스테로프 모멘텀(NAG)`

```python
#Adagrad 함수 사용 + 파라미터에 momentum,nesterov 추가
optimizer=tf.keras.optimizers.SGD(lr=0.1, momentum = 0.9, nesterov=True)
```

`아다그라드(Adagrad)`

```python
#Adagrad 함수 사용
optimizer=tf.keras.optimizers.Adagrad(lr=0.01, epsilon = 1e-6)
```

`알엠에스프롭(RMSProp)`

```python
#RMSprop 함수 사용
optimizer=tf.keras.optimizers.RMSprop(lr=0.001, rho = 0.9, epsilon = 1e-08, decay = 0.0)
```

`아담(Adam)`

```python
#Adam 함수 사용
optimizer=tf.keras.optimizers.Adam(lr=0.001, beta_1 = 0.9, beta_2 = 0.999, epsilon = 1e-08, decay = 0.0)
```

### 배치 사이즈

학습시 샘플 데이터를 한번에 몇 개씩 처리할지 정하는 부분

ex) batch_size = 10 일 경우 항번에 샘플 데이터를 10개씩 끊어서 수행

**배치 사이즈가 너무 크면 학습 속도가 느려지고, 너무 작으면 실행 값의 편차가 생겨 전체 결과갑이 불안정해질 수 있다.**

1. 전체 데이터 개수 = 300, 배치 사이즈 = 30 -> 1 epoch당 가중치 10
2. 전체 데이터 개수 = 300, 배치 사이즈 = 10 -> 1 epoch당 가중치 30

### metrics

모델의 성능을 평가하는 항목

accuracy, Precision, recall 중 accuracy만 공부

![image](https://user-images.githubusercontent.com/78605779/171835766-e19e57c2-7cf0-40aa-82d4-6d29b17d6fc8.png)

### 폐암 환자 생존율 실습

우리가 알고 싶은 데이터는 환자의 생존 여부이다.

**생존 여부는 숫자 하나로 출력되기 때문에 출력층을 1개로 설정**

![image](https://user-images.githubusercontent.com/78605779/171837412-f3df7bb1-01d9-4d4c-9e2e-7f2b28253117.png)
![image](https://user-images.githubusercontent.com/78605779/171837375-c27bd1c6-3fa5-4ff8-988f-1dde66fcda09.png)

### DNN(Deep Neural Networks)

Deep Neural Networks은 다층 퍼셉트론에서 은닉층의 개수를 증가 시킨 것

Deep은 은닉층이 많은 것을 의미

### 딥러닝 예제

#### 피마 인디언 데이터 분석

피마 인디언의 여러가지 정보를 토대로 당뇨병의 여부를 판단

두 항목씩 짝을 지어 가각 어떤 패턴으로 변화하는지 관찰할 수 있는 Heatamp 함수 사용

![image](https://user-images.githubusercontent.com/78605779/171839748-1d44654f-974e-498e-a531-48f45d190201.png)

Class(당뇨병 여부) 부분에서 가장 숫자가 높은 것이 무언인지 -> 무엇이 가장 큰 영향을 미치는지

당뇨병 결과 여부가 0 또는 1이기 때문에 출력층의 활성화 함수는 sigmoid가 적당하다.

#### 아이리스 품종 예측

![image](https://user-images.githubusercontent.com/78605779/171840799-60cac8a3-0dd5-4895-a0d7-5ba2f844d9bc.png)

아이리스 품종은 문자열로 나타나있기 때문에 숫자로 변환해주는 과정이 필요

문자열을 숫자로 변환후 나온 값을 다시 0과 1로만 이루어진 형태로 변환해주는 원-핫-인코딩 과정을 처리

```python
# One-hot-encoding
array([1,2,3]) -> array([[1.,0.,0.],[0.,1.,0.],[0.,0.,1.]])
```

![image](https://user-images.githubusercontent.com/78605779/171844461-e4cd9ff5-0529-42fd-b613-6c5fcd0bc7d4.png)

원 핫 인코딩일 경우 원하는 결과의 가지 수 및 활성화 함수를 softmax로 사용

#### 초음파 광물 예측

`과적합, k겹 교차 검증등 ppt 확인하기`

### 케라스 신경망 실습

#### 타이타닉 생존자 예측, 패션 아이템 분류

코드와 결과를 보고 해석할줄 알아야함

#### 와인 종류 예측하기

![image](https://user-images.githubusercontent.com/78605779/171855413-a9d864a5-2658-451f-a99c-10e26c235060.png)

기존 데이터를 학습 데이터와 테스트 데이터로 나눈 후 학습 데이터에서 일부분을 최적의 학습 파라미터를 찾기 위한 검증 데이터로 분리한다.

검증 데이터를 통해 테스트한 결과를 추적하면서 최적의 모델을 만들 수 있다.

`학습 자동 중단`

오차가 계속 줄어들지 않을 경우 자주 사용한다.

```python
# moditor -> 기준, patience -> 횟수
EarlyStopping(moditor='val_loss', patience=20)
```

-> 검증셋의 오차가 20번 이상 줄어들지 않을 경우 학습을 중지한다.

`가장 좋은 결과를 저장`

```python
ModelCheckPoint(filepath=modelpath, moditor='val_loss', verbose=0, save_best_only=True)
```

moditor가 개선될 때 마다 파일을 저장하여 학습이 종료되었을 때 가장 좋은 결과를 확인할 수 있다.

#### 주택 가격 예측

**기존에 예제들과 달리 회귀에 대한 예제로 출력층에 활성화 함수가 존재하지 않는다.**

### 영상 처리 기초: open cv

```
모든 내용 ppt로 코드 및 결과 분석해보기
```
